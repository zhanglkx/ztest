# TypeScript è£…é¥°å™¨å­¦ä¹ æŒ‡å—

> å®Œæ•´çš„ TypeScript è£…é¥°å™¨å­¦ä¹ èµ„æ–™ï¼Œä»åŸºç¡€åˆ°é«˜çº§ï¼Œä»ç†è®ºåˆ°å®æˆ˜

## ğŸ“š ç›®å½•

- [ä»€ä¹ˆæ˜¯è£…é¥°å™¨](#ä»€ä¹ˆæ˜¯è£…é¥°å™¨)
- [ç¯å¢ƒé…ç½®](#ç¯å¢ƒé…ç½®)
- [è£…é¥°å™¨ç±»å‹](#è£…é¥°å™¨ç±»å‹)
- [å­¦ä¹ è·¯å¾„](#å­¦ä¹ è·¯å¾„)
- [æ–‡ä»¶è¯´æ˜](#æ–‡ä»¶è¯´æ˜)
- [è¿è¡Œç¤ºä¾‹](#è¿è¡Œç¤ºä¾‹)
- [è¿›é˜¶ä¸»é¢˜](#è¿›é˜¶ä¸»é¢˜)
- [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

## ä»€ä¹ˆæ˜¯è£…é¥°å™¨

è£…é¥°å™¨æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„å£°æ˜ï¼Œå®ƒèƒ½å¤Ÿè¢«é™„åŠ åˆ°ç±»å£°æ˜ã€æ–¹æ³•ã€è®¿é—®å™¨ã€å±æ€§æˆ–å‚æ•°ä¸Šã€‚è£…é¥°å™¨ä½¿ç”¨ `@expression` è¿™ç§å½¢å¼ï¼Œå…¶ä¸­ `expression` æ±‚å€¼åå¿…é¡»ä¸ºä¸€ä¸ªå‡½æ•°ã€‚

### æ ¸å¿ƒç‰¹ç‚¹

- **å£°æ˜å¼ç¼–ç¨‹**ï¼šç”¨è£…é¥°å™¨å£°æ˜æ„å›¾ï¼Œè€Œä¸æ˜¯æ‰‹åŠ¨ç¼–å†™é‡å¤ä»£ç 
- **ä»£ç å¤ç”¨**ï¼šå°†æ¨ªåˆ‡å…³æ³¨ç‚¹ï¼ˆæ—¥å¿—ã€éªŒè¯ã€ç¼“å­˜ç­‰ï¼‰æŠ½ç¦»æˆå¯å¤ç”¨çš„è£…é¥°å™¨
- **å…ƒç¼–ç¨‹**ï¼šåœ¨ä¸ä¿®æ”¹åŸå§‹ä»£ç çš„æƒ…å†µä¸‹å¢å¼ºåŠŸèƒ½
- **å¯ç»„åˆ**ï¼šå¤šä¸ªè£…é¥°å™¨å¯ä»¥ç»„åˆä½¿ç”¨

### å®é™…åº”ç”¨

è£…é¥°å™¨åœ¨ç°ä»£ TypeScript æ¡†æ¶ä¸­è¢«å¹¿æ³›ä½¿ç”¨ï¼š

- **Angular**ï¼šç»„ä»¶ã€æœåŠ¡ã€ä¾èµ–æ³¨å…¥
- **NestJS**ï¼šæ§åˆ¶å™¨ã€è·¯ç”±ã€ä¸­é—´ä»¶
- **TypeORM**ï¼šå®ä½“å®šä¹‰ã€å…³ç³»æ˜ å°„
- **class-validator**ï¼šæ•°æ®éªŒè¯

## ç¯å¢ƒé…ç½®

### 1. TypeScript é…ç½®

åœ¨ `tsconfig.json` ä¸­å¯ç”¨è£…é¥°å™¨æ”¯æŒï¼š

```json
{
  "compilerOptions": {
    "target": "ES2015",
    "experimentalDecorators": true,      // å¿…éœ€ï¼šå¯ç”¨è£…é¥°å™¨
    "emitDecoratorMetadata": true       // å¯é€‰ï¼šå¯ç”¨å…ƒæ•°æ®åå°„
  }
}
```

### 2. å®‰è£…ä¾èµ–

å¦‚æœè¦ä½¿ç”¨å…ƒæ•°æ®åå°„ï¼Œéœ€è¦å®‰è£…ï¼š

```bash
npm install reflect-metadata
```

### 3. è¿è¡Œç¯å¢ƒ

æ¨èä½¿ç”¨ä»¥ä¸‹æ–¹å¼è¿è¡Œç¤ºä¾‹ï¼š

```bash
# ä½¿ç”¨ ts-node
npm install -g ts-node
ts-node decorator/1-class-basic.ts

# æˆ–ä½¿ç”¨ tsx (æ›´å¿«)
npm install -g tsx
tsx decorator/1-class-basic.ts
```

## è£…é¥°å™¨ç±»å‹

TypeScript æ”¯æŒ 5 ç§è£…é¥°å™¨ç±»å‹ï¼š

| ç±»å‹ | åº”ç”¨ç›®æ ‡ | ç­¾å | ç”¨é€” |
|------|---------|------|------|
| **ç±»è£…é¥°å™¨** | ç±»å£°æ˜ | `(constructor: Function) => Function \| void` | ä¿®æ”¹æˆ–æ›¿æ¢ç±»å®šä¹‰ |
| **æ–¹æ³•è£…é¥°å™¨** | æ–¹æ³• | `(target, key, descriptor) => PropertyDescriptor \| void` | ä¿®æ”¹æ–¹æ³•è¡Œä¸º |
| **è®¿é—®å™¨è£…é¥°å™¨** | get/set | `(target, key, descriptor) => PropertyDescriptor \| void` | ä¿®æ”¹è®¿é—®å™¨è¡Œä¸º |
| **å±æ€§è£…é¥°å™¨** | å±æ€§ | `(target, key) => void` | è§‚å¯Ÿå±æ€§å®šä¹‰ |
| **å‚æ•°è£…é¥°å™¨** | æ–¹æ³•å‚æ•° | `(target, key, index) => void` | è®°å½•å‚æ•°ä¿¡æ¯ |

### è£…é¥°å™¨å·¥å‚

è£…é¥°å™¨å·¥å‚æ˜¯ä¸€ä¸ªè¿”å›è£…é¥°å™¨çš„å‡½æ•°ï¼Œå…è®¸ä¼ é€’å‚æ•°é…ç½®è£…é¥°å™¨ï¼š

```typescript
// è£…é¥°å™¨å·¥å‚
function Log(level: string) {
  // è¿”å›çœŸæ­£çš„è£…é¥°å™¨
  return function (target, key, descriptor) {
    // ... è£…é¥°å™¨é€»è¾‘
  }
}

// ä½¿ç”¨
@Log("INFO")
method() {}
```

## å­¦ä¹ è·¯å¾„

### ğŸ¯ å»ºè®®å­¦ä¹ é¡ºåº

```
ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€è£…é¥°å™¨
â”œâ”€â”€ 1. 1-class-basic.ts           - ç±»è£…é¥°å™¨åŸºç¡€
â”œâ”€â”€ 2. 2-class-factory.ts         - ç±»è£…é¥°å™¨å·¥å‚
â”œâ”€â”€ 3. 3-method-basic.ts          - æ–¹æ³•è£…é¥°å™¨
â”œâ”€â”€ 4. 4-method-factory.ts        - æ–¹æ³•è£…é¥°å™¨å·¥å‚
â””â”€â”€ 5. 5-property.ts              - å±æ€§è£…é¥°å™¨

ç¬¬äºŒé˜¶æ®µï¼šè¿›é˜¶è£…é¥°å™¨
â”œâ”€â”€ 6. 6-accessor-basic.ts        - è®¿é—®å™¨è£…é¥°å™¨
â”œâ”€â”€ 7. 7-accessor-factory.ts      - è®¿é—®å™¨è£…é¥°å™¨å·¥å‚
â””â”€â”€ 8. 8-parameter-basic.ts       - å‚æ•°è£…é¥°å™¨

ç¬¬ä¸‰é˜¶æ®µï¼šé«˜çº§ä¸»é¢˜
â”œâ”€â”€ 9. 9-parameter-combination.ts - å‚æ•°è£…é¥°å™¨ç»„åˆ
â”œâ”€â”€ 10. 10-execution-order.ts     - æ‰§è¡Œé¡ºåº
â””â”€â”€ 11. 11-decorator-combination.ts - å¤šè£…é¥°å™¨ç»„åˆ

ç¬¬å››é˜¶æ®µï¼šå®æˆ˜åº”ç”¨
â”œâ”€â”€ 12. 12-practical-examples.ts  - å®ç”¨åœºæ™¯
â””â”€â”€ 13. 13-metadata-reflection.ts - å…ƒæ•°æ®åå°„
```

### ğŸ“– æ¯ä¸ªé˜¶æ®µçš„å­¦ä¹ è¦ç‚¹

#### ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€è£…é¥°å™¨

- ç†è§£è£…é¥°å™¨çš„åŸºæœ¬æ¦‚å¿µ
- æŒæ¡å„ç±»è£…é¥°å™¨çš„ç­¾åå’Œç”¨æ³•
- å­¦ä¼šåˆ›å»ºè£…é¥°å™¨å·¥å‚

#### ç¬¬äºŒé˜¶æ®µï¼šè¿›é˜¶è£…é¥°å™¨

- ç†è§£è®¿é—®å™¨è£…é¥°å™¨çš„ç‰¹æ®Šæ€§
- æŒæ¡å‚æ•°è£…é¥°å™¨çš„ä½¿ç”¨åœºæ™¯
- ç†è§£è£…é¥°å™¨çš„å±€é™æ€§

#### ç¬¬ä¸‰é˜¶æ®µï¼šé«˜çº§ä¸»é¢˜

- ç†è§£è£…é¥°å™¨çš„æ‰§è¡Œé¡ºåº
- æŒæ¡å¤šè£…é¥°å™¨çš„ç»„åˆä½¿ç”¨
- ç†è§£è£…é¥°å™¨ä¹‹é—´çš„åä½œ

#### ç¬¬å››é˜¶æ®µï¼šå®æˆ˜åº”ç”¨

- å­¦ä¹ å¸¸è§çš„è£…é¥°å™¨æ¨¡å¼
- ç†è§£å…ƒæ•°æ®åå°„çš„åŸç†
- èƒ½å¤Ÿè®¾è®¡è‡ªå·±çš„è£…é¥°å™¨ç³»ç»Ÿ

## æ–‡ä»¶è¯´æ˜

### åŸºç¡€è£…é¥°å™¨æ–‡ä»¶

#### `1-class-basic.ts` - çº¯ç±»è£…é¥°å™¨
- âœ… æ·»åŠ é™æ€å±æ€§
- âœ… æ›¿æ¢æ„é€ å‡½æ•°
- âœ… å¯†å°/å†»ç»“ç±»
- âœ… å•ä¾‹æ¨¡å¼
- âœ… æ—¥å¿—è®°å½•
- âœ… è‡ªåŠ¨ç»‘å®šæ–¹æ³•

#### `2-class-factory.ts` - ç±»è£…é¥°å™¨å·¥å‚
- âœ… åŸºç¡€ç±»è£…é¥°å™¨ç¤ºä¾‹
- âœ… æ³¨å…¥å±æ€§
- âœ… å¯†å°ç±»
- âœ… æ·»åŠ æ—¶é—´æˆ³

#### `5-property.ts` - å±æ€§è£…é¥°å™¨
- âœ… è®¾ç½®é»˜è®¤å€¼
- âœ… åªè¯»å±æ€§
- âœ… å±æ€§æ ¼å¼åŒ–

#### `3-method-basic.ts` - æ–¹æ³•è£…é¥°å™¨
- âœ… ä¿®æ”¹å‚æ•°
- âœ… æ€§èƒ½ç›‘æ§
- âœ… é”™è¯¯å¤„ç†

#### `4-method-factory.ts` - æ–¹æ³•è£…é¥°å™¨å·¥å‚
- âœ… æ³¨å…¥å‰ç¼€
- âœ… æ—¥å¿—çº§åˆ«
- âœ… é‡è¯•æœºåˆ¶

#### `8-parameter-basic.ts` - å‚æ•°è£…é¥°å™¨
- âœ… è®°å½•å‚æ•°ä¿¡æ¯
- âœ… æ ‡è®°å¿…éœ€å‚æ•°
- âœ… å‚æ•°ç±»å‹è®°å½•

#### `9-parameter-combination.ts` - å‚æ•°è£…é¥°å™¨ç»„åˆ
- âœ… å¿…éœ€å‚æ•°éªŒè¯
- âœ… å‚æ•°ç±»å‹éªŒè¯
- âœ… ä¸æ–¹æ³•è£…é¥°å™¨åä½œ

### è¿›é˜¶è£…é¥°å™¨æ–‡ä»¶

#### `6-accessor-basic.ts` - è®¿é—®å™¨è£…é¥°å™¨
- âœ… æ—¥å¿—è®°å½•
- âœ… è®¿é—®æ§åˆ¶
- âœ… å€¼è½¬æ¢
- âœ… ç¼“å­˜
- âœ… å€¼éªŒè¯

#### `7-accessor-factory.ts` - è®¿é—®å™¨è£…é¥°å™¨å·¥å‚
- âœ… èŒƒå›´éªŒè¯
- âœ… æ ¼å¼åŒ–
- âœ… å»¶è¿ŸåŠ è½½
- âœ… è®¿é—®é¢‘ç‡é™åˆ¶
- âœ… ç±»å‹è½¬æ¢

### é«˜çº§ä¸»é¢˜æ–‡ä»¶

#### `10-execution-order.ts` - è£…é¥°å™¨æ‰§è¡Œé¡ºåº
- âœ… å®Œæ•´æ‰§è¡Œé¡ºåºæ¼”ç¤º
- âœ… å¤šè£…é¥°å™¨æ´‹è‘±æ¨¡å‹
- âœ… è£…é¥°å™¨å·¥å‚æ‰§è¡Œé¡ºåº
- âœ… é¡ºåºè¿½è¸ªç¤ºä¾‹

#### `11-decorator-combination.ts` - å¤šè£…é¥°å™¨ç»„åˆ
- âœ… æ—¥å¿— + æ€§èƒ½ç›‘æ§
- âœ… éªŒè¯ + ç¼“å­˜ + æ—¥å¿—
- âœ… æƒé™ + é‡è¯• + é”™è¯¯å¤„ç†
- âœ… å¤šç±»è£…é¥°å™¨ç»„åˆ

### å®æˆ˜åº”ç”¨æ–‡ä»¶

#### `12-practical-examples.ts` - å®ç”¨åœºæ™¯ç¤ºä¾‹
åŒ…å« 8 ä¸ªå¸¸ç”¨è£…é¥°å™¨ï¼š
1. **@Log** - æ—¥å¿—è®°å½•
2. **@Performance** - æ€§èƒ½ç›‘æ§
3. **@Cache** - ç»“æœç¼“å­˜
4. **@Debounce** - é˜²æŠ–
5. **@Throttle** - èŠ‚æµ
6. **@Authorize** - æƒé™éªŒè¯
7. **@Readonly** - åªè¯»å±æ€§
8. **@Retry** - å¤±è´¥é‡è¯•

#### `13-metadata-reflection.ts` - å…ƒæ•°æ®åå°„
- âœ… è‡ªå®šä¹‰å…ƒæ•°æ®å­˜å‚¨
- âœ… ç±»å‹å…ƒæ•°æ®éªŒè¯
- âœ… ä¾èµ–æ³¨å…¥å®ç°
- âœ… è·¯ç”±è£…é¥°å™¨

## è¿è¡Œç¤ºä¾‹

### å•ç‹¬è¿è¡Œæ–‡ä»¶

```bash
# ç±»è£…é¥°å™¨åŸºç¡€
tsx decorator/1-class-basic.ts

# æ–¹æ³•è£…é¥°å™¨
tsx decorator/3-method-basic.ts

# å®ç”¨åœºæ™¯
tsx decorator/12-practical-examples.ts
```

### è¿è¡Œæ‰€æœ‰ç¤ºä¾‹

```bash
# åˆ›å»ºä¸€ä¸ªè¿è¡Œè„šæœ¬
for file in decorator/*.ts; do
  echo "======= Running $file ======="
  tsx "$file"
  echo ""
done
```

## è¿›é˜¶ä¸»é¢˜

### è£…é¥°å™¨æ‰§è¡Œé¡ºåº

1. **å®ä¾‹æˆå‘˜** â†’ **é™æ€æˆå‘˜** â†’ **æ„é€ å‡½æ•°å‚æ•°** â†’ **ç±»**
2. åŒä¸€æˆå‘˜ï¼š**å‚æ•°** â†’ **æ–¹æ³•/è®¿é—®å™¨/å±æ€§**
3. å¤šä¸ªè£…é¥°å™¨ï¼š**æ±‚å€¼ä»ä¸Šåˆ°ä¸‹**ï¼Œ**è°ƒç”¨ä»ä¸‹åˆ°ä¸Š**ï¼ˆæ´‹è‘±æ¨¡å‹ï¼‰

```typescript
@ClassDec       // 4. æœ€åæ‰§è¡Œ
class Example {
  @PropDec      // 1. ç¬¬ä¸€ä¸ªæ‰§è¡Œ
  prop: string;

  @MethodDec    // 3. ç¬¬ä¸‰ä¸ªæ‰§è¡Œ
  method(@ParamDec param) {  // 2. ç¬¬äºŒä¸ªæ‰§è¡Œ
    // ...
  }
}
```

### è£…é¥°å™¨ç»„åˆæ¨¡å¼

#### æ´‹è‘±æ¨¡å‹ï¼ˆOnion Modelï¼‰

```typescript
@First   // æœ€å¤–å±‚
@Second  // ä¸­é—´å±‚
@Third   // æœ€å†…å±‚
method() {
  // æ‰§è¡Œé¡ºåºï¼šThird â†’ Second â†’ First â†’ æ–¹æ³• â†’ First â†’ Second â†’ Third
}
```

#### ç®¡é“æ¨¡å¼ï¼ˆPipeline Patternï¼‰

```typescript
@Validate   // 1. éªŒè¯
@Transform  // 2. è½¬æ¢
@Cache      // 3. ç¼“å­˜
@Log        // 4. æ—¥å¿—
method() {}
```

### å…ƒæ•°æ®åå°„

ä½¿ç”¨ `reflect-metadata` åº“å­˜å‚¨å’Œè¯»å–å…ƒæ•°æ®ï¼š

```typescript
import "reflect-metadata";

// å­˜å‚¨å…ƒæ•°æ®
Reflect.defineMetadata("key", "value", target, propertyKey);

// è¯»å–å…ƒæ•°æ®
const value = Reflect.getMetadata("key", target, propertyKey);

// å†…ç½®å…ƒæ•°æ®ï¼ˆéœ€è¦ emitDecoratorMetadata: trueï¼‰
const paramTypes = Reflect.getMetadata("design:paramtypes", target, propertyKey);
const returnType = Reflect.getMetadata("design:returntype", target, propertyKey);
const propertyType = Reflect.getMetadata("design:type", target, propertyKey);
```

## æœ€ä½³å®è·µ

### 1. ä¿æŒè£…é¥°å™¨ç®€å•

```typescript
// âœ… å¥½ï¼šå•ä¸€èŒè´£
@Log
@Validate
method() {}

// âŒ é¿å…ï¼šä¸€ä¸ªè£…é¥°å™¨åšå¤ªå¤šäº‹
@LogAndValidateAndCache
method() {}
```

### 2. ä½¿ç”¨è£…é¥°å™¨å·¥å‚æä¾›é…ç½®

```typescript
// âœ… å¥½ï¼šå¯é…ç½®
@Cache({ ttl: 5000, key: "custom-key" })
getData() {}

// âŒ é¿å…ï¼šç¡¬ç¼–ç 
@CacheFor5Seconds
getData() {}
```

### 3. æ³¨æ„è£…é¥°å™¨æ‰§è¡Œé¡ºåº

```typescript
// âœ… å¥½ï¼šç†è§£é¡ºåº
@Authorize    // å…ˆéªŒè¯æƒé™
@Log          // å†è®°å½•æ—¥å¿—
@Cache        // æœ€åç¼“å­˜
method() {}

// âŒ é¿å…ï¼šé¡ºåºé”™è¯¯
@Cache        // å¯èƒ½ç¼“å­˜æœªæˆæƒçš„ç»“æœ
@Authorize
method() {}
```

### 4. ç±»å‹å®‰å…¨

```typescript
// âœ… å¥½ï¼šä½¿ç”¨æ³›å‹ä¿æŒç±»å‹å®‰å…¨
function Injectable<T extends { new(...args: any[]): {} }>(constructor: T) {
  return class extends constructor {
    // ...
  };
}

// âŒ é¿å…ï¼šä¸¢å¤±ç±»å‹ä¿¡æ¯
function Injectable(constructor: any) {
  // ...
}
```

### 5. é”™è¯¯å¤„ç†

```typescript
// âœ… å¥½ï¼šä¼˜é›…çš„é”™è¯¯å¤„ç†
function Validate(target, key, descriptor) {
  const original = descriptor.value;
  descriptor.value = function(...args) {
    try {
      // éªŒè¯é€»è¾‘
      return original.apply(this, args);
    } catch (error) {
      console.error(`éªŒè¯å¤±è´¥: ${error.message}`);
      throw error;
    }
  };
}
```

### 6. æ–‡æ¡£å’Œå‘½å

```typescript
// âœ… å¥½ï¼šæ¸…æ™°çš„å‘½åå’Œæ–‡æ¡£
/**
 * ç¼“å­˜æ–¹æ³•çš„è¿”å›å€¼
 * @param ttl ç¼“å­˜æœ‰æ•ˆæœŸï¼ˆæ¯«ç§’ï¼‰
 */
function Cache(ttl: number) {
  // ...
}

// âŒ é¿å…ï¼šæ¨¡ç³Šçš„å‘½å
function C(t: number) {
  // ...
}
```

## å¸¸è§é—®é¢˜

### Q1: è£…é¥°å™¨ä»€ä¹ˆæ—¶å€™æ‰§è¡Œï¼Ÿ

**A:** è£…é¥°å™¨åœ¨ç±»**å®šä¹‰æ—¶**æ‰§è¡Œï¼Œè€Œä¸æ˜¯å®ä¾‹åŒ–æ—¶ã€‚è£…é¥°å™¨åªä¼šè¿è¡Œä¸€æ¬¡ã€‚

```typescript
@MyDecorator  // åœ¨è¿™é‡Œæ‰§è¡Œï¼Œåªæ‰§è¡Œä¸€æ¬¡
class Example {}

const obj1 = new Example(); // è£…é¥°å™¨ä¸ä¼šå†æ¬¡æ‰§è¡Œ
const obj2 = new Example(); // è£…é¥°å™¨ä¸ä¼šå†æ¬¡æ‰§è¡Œ
```

### Q2: å¦‚ä½•åœ¨è£…é¥°å™¨ä¸­è®¿é—® thisï¼Ÿ

**A:** åœ¨æ–¹æ³•è£…é¥°å™¨ä¸­åŒ…è£…æ–¹æ³•æ—¶ï¼Œä½¿ç”¨ç®­å¤´å‡½æ•°æˆ– apply/callï¼š

```typescript
// âœ… æ­£ç¡®
descriptor.value = function(...args) {
  return originalMethod.apply(this, args); // ä¿æŒ this ä¸Šä¸‹æ–‡
};

// âŒ é”™è¯¯
descriptor.value = (...args) => {
  return originalMethod.apply(this, args); // this ç»‘å®šåˆ°è£…é¥°å™¨ä½œç”¨åŸŸ
};
```

### Q3: è£…é¥°å™¨å¯ä»¥æ˜¯å¼‚æ­¥çš„å—ï¼Ÿ

**A:** è£…é¥°å™¨æœ¬èº«ä¸èƒ½æ˜¯å¼‚æ­¥çš„ï¼Œä½†å¯ä»¥åŒ…è£…å¼‚æ­¥æ–¹æ³•ï¼š

```typescript
function Async(target, key, descriptor) {
  const original = descriptor.value;
  descriptor.value = async function(...args) {
    // å¯ä»¥åœ¨è¿™é‡Œä½¿ç”¨ await
    return await original.apply(this, args);
  };
}
```

### Q4: å¦‚ä½•è°ƒè¯•è£…é¥°å™¨ï¼Ÿ

**A:** åœ¨è£…é¥°å™¨å†…éƒ¨æ·»åŠ  console.log æˆ–æ–­ç‚¹ï¼š

```typescript
function Debug(target, key, descriptor) {
  console.log('è£…é¥°å™¨è¢«è°ƒç”¨');
  console.log('target:', target);
  console.log('key:', key);
  console.log('descriptor:', descriptor);
  
  // è®¾ç½®æ–­ç‚¹
  debugger;
  
  return descriptor;
}
```

### Q5: è£…é¥°å™¨ä¼šå½±å“æ€§èƒ½å—ï¼Ÿ

**A:** è£…é¥°å™¨åœ¨ç±»å®šä¹‰æ—¶åªæ‰§è¡Œä¸€æ¬¡ï¼Œå¯¹æ€§èƒ½å½±å“å¾ˆå°ã€‚ä½†åŒ…è£…çš„é€»è¾‘ä¼šåœ¨æ¯æ¬¡è°ƒç”¨æ—¶æ‰§è¡Œï¼Œéœ€è¦æ³¨æ„ï¼š

```typescript
// æ³¨æ„ï¼šè¿™ä¼šåœ¨æ¯æ¬¡è°ƒç”¨ method æ—¶éƒ½åˆ›å»ºæ–°å¯¹è±¡
function Cache(target, key, descriptor) {
  descriptor.value = function(...args) {
    const cache = new Map(); // âŒ æ¯æ¬¡è°ƒç”¨éƒ½åˆ›å»º
    // ...
  };
}

// æ”¹è¿›ï¼šåœ¨è£…é¥°å™¨ä½œç”¨åŸŸåˆ›å»ºä¸€æ¬¡
function Cache(target, key, descriptor) {
  const cache = new Map(); // âœ… åªåˆ›å»ºä¸€æ¬¡
  descriptor.value = function(...args) {
    // ...
  };
}
```

### Q6: TypeScript 5.0+ çš„è£…é¥°å™¨æœ‰ä»€ä¹ˆå˜åŒ–ï¼Ÿ

**A:** TypeScript 5.0 å¼•å…¥äº† ECMAScript è£…é¥°å™¨æ ‡å‡†ï¼ˆStage 3ï¼‰ï¼Œä¸æ—§ç‰ˆæœ¬æœ‰æ‰€ä¸åŒï¼š

- é»˜è®¤ä½¿ç”¨æ–°çš„è£…é¥°å™¨å®ç°
- ä¸éœ€è¦ `experimentalDecorators` é…ç½®
- è¯­æ³•å’Œè¡Œä¸ºæœ‰ç»†å¾®å·®å¼‚

æœ¬æ•™ç¨‹ä½¿ç”¨çš„æ˜¯ä¼ ç»Ÿè£…é¥°å™¨ï¼ˆéœ€è¦ `experimentalDecorators: true`ï¼‰ï¼Œå› ä¸ºå®ƒåœ¨ç°æœ‰æ¡†æ¶ä¸­æ›´å¸¸è§ã€‚

## èµ„æºé“¾æ¥

- [TypeScript å®˜æ–¹æ–‡æ¡£ - è£…é¥°å™¨](https://www.typescriptlang.org/docs/handbook/decorators.html)
- [reflect-metadata](https://github.com/rbuckton/reflect-metadata)
- [è£…é¥°å™¨ææ¡ˆ](https://github.com/tc39/proposal-decorators)

## è®¸å¯è¯

æœ¬æ•™ç¨‹ä»…ä¾›å­¦ä¹ ä½¿ç”¨ã€‚

---

**å¿«é€Ÿå¼€å§‹**: ä» `1-class-basic.ts` å¼€å§‹ï¼ŒæŒ‰ç…§å­¦ä¹ è·¯å¾„é€æ­¥å­¦ä¹ ï¼

**é‡åˆ°é—®é¢˜**: æŸ¥çœ‹å¸¸è§é—®é¢˜éƒ¨åˆ†æˆ–åœ¨ç¤ºä¾‹æ–‡ä»¶ä¸­æŸ¥æ‰¾ç›¸å…³ç¤ºä¾‹ã€‚

**å®è·µå»ºè®®**: æ¯å­¦å®Œä¸€ä¸ªæ–‡ä»¶ï¼Œå°è¯•è‡ªå·±å®ç°ä¸€ä¸ªç±»ä¼¼çš„è£…é¥°å™¨ï¼

ç¥å­¦ä¹ æ„‰å¿«ï¼ğŸ‰
